import{r as u,j as i,L as v}from"./index-B-0CnHw8.js";class b{container;fullDepth;depth;pixelRatio;growthSpeed;treeScale;branchWidth;colorMode;color;gradientStart;gradientEnd;leafColor;leafSize;originalSeed;seed;randSeq;randCounter;canvas;ctx;branches;animation;currentDepth;stageWidth;stageHeight;treeTop;treeX;treeY;constructor(e){this.container=e.container,this.fullDepth=11,this.depth=e.depth||this.fullDepth,this.pixelRatio=window.devicePixelRatio>1?2:1,this.growthSpeed=e.growthSpeed,this.treeScale=e.treeScale,this.branchWidth=e.branchWidth,this.colorMode=e.colorMode,this.color=e.color,this.gradientStart=e.gradientColorStart,this.gradientEnd=e.gradientColorEnd,this.leafColor=e.leafColor,this.leafSize=e.leafSize,this.originalSeed=e.seed,this.seed=Math.random()*1e5,typeof this.originalSeed=="string"&&(this.seed=[...this.originalSeed].reduce((t,c)=>t*31+c.charCodeAt(0),0)),console.log(this.seed);const h=1e4;this.randSeq=[];let s=this.seed;for(let t=0;t<h;t++){s=s*16807%2147483647;const c=(s-1)/2147483646;this.randSeq.push(c)}this.randCounter=0,this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas);const r=this.canvas.getContext("2d");if(!r)throw new Error("Canvas context not available");this.ctx=r,this.branches=[],this.animation=null,this.currentDepth=0,this.treeTop=1/0,this.treeX=0,this.treeY=0,this.addEventListeners(),this.resize(),this.startTree(this.stageWidth/2,this.stageHeight)}addEventListeners(){window.addEventListener("resize",this.resize.bind(this))}resize(){const e=this.container.clientWidth,h=this.container.clientHeight;e===this.stageWidth&&Math.abs(h-this.stageHeight)<50||(this.stageWidth=this.container.clientWidth,this.stageHeight=this.container.clientHeight,this.canvas.width=this.stageWidth,this.canvas.height=this.stageHeight,this.ctx.setTransform(1,0,0,1,0,0),this.treeScale=Math.min(this.stageWidth,this.stageHeight)/800,this.clearCanvas(),this.startTree(this.stageWidth/2,this.stageHeight))}clearCanvas(){this.ctx.clearRect(0,0,this.stageWidth,this.stageHeight)}startTree(e,h){this.animation&&cancelAnimationFrame(this.animation),this.clearCanvas(),this.seed!==void 0&&(this.randCounter=0),this.branches=Array.from({length:this.fullDepth},()=>[]),this.currentDepth=0,this.treeTop=1/0,this.treeX=e,this.treeY=h;const s=Math.min(this.stageWidth,this.stageHeight)/(13*this.fullDepth);this.treeScale>s&&(this.treeScale=s),this.createBranch(this.treeX,this.treeY,-90,0);for(let r=0;r<this.fullDepth;r++)for(let t=0;t<this.branches[r].length;t++)this.branches[r][t].cntFrame=0;this.animate()}growOneLevel(){this.depth<this.fullDepth&&(this.depth++,this.leafSize++,this.animate())}growBackOneLevel(){this.depth>1&&(this.depth--,this.leafSize--,this.animate())}random(e,h){return this.randSeq&&this.randCounter!==void 0?e+this.randSeq[this.randCounter++]*(h-e):Math.random()*(h-e)+e}degToRad(e){return e*(Math.PI/180)}createBranch(e,h,s,r){if(r===this.fullDepth)return;const t=this.treeScale,c=(r===0?this.random(10,13):this.random(0,11))*t,f=this.fullDepth-r,x=e+Math.cos(this.degToRad(s))*c*f,o=h+Math.sin(this.degToRad(s))*c*f;h<this.treeTop&&(this.treeTop=h),o<this.treeTop&&(this.treeTop=o);const d=this.branchWidth,n={startX:e,startY:h,endX:x,endY:o,lineWidth:f*d,frame:100,cntFrame:0,plugin:this,depth:r,draw:(a,l)=>{if(n.cntFrame<n.frame){a.beginPath();const m=n.cntFrame/n.frame,p=n.startX+(n.endX-n.startX)*m,w=n.startY+(n.endY-n.startY)*m;if(a.moveTo(n.startX,n.startY),a.lineTo(p,w),a.lineWidth=n.lineWidth,this.colorMode==="gradient"){const S=a.createLinearGradient(this.treeX,this.treeY,this.treeX,this.treeTop);S.addColorStop(0,this.gradientStart),S.addColorStop(1,this.gradientEnd),a.strokeStyle=S}else a.strokeStyle=this.color;return a.stroke(),a.closePath(),n.cntFrame+=l,!1}return!0}};this.branches[r].push(n),this.createBranch(x,o,s-this.random(15,23),r+1),this.createBranch(x,o,s+this.random(15,23),r+1)}drawLeaf(e,h){this.ctx.beginPath(),this.ctx.arc(e,h,this.leafSize,0,Math.PI*2),this.ctx.fillStyle=this.leafColor,this.ctx.fill(),this.ctx.closePath()}animate(){this.clearCanvas();const e=[];for(let s=0;s<this.currentDepth&&!(s>=this.depth);s++)for(let r=0;r<this.branches[s].length;r++){const t=this.branches[s][r];if(this.ctx.beginPath(),this.ctx.moveTo(t.startX,t.startY),this.ctx.lineTo(t.endX,t.endY),this.ctx.lineWidth=t.lineWidth,this.colorMode==="gradient"){const c=this.ctx.createLinearGradient(this.treeX,this.treeY,this.treeX,this.treeTop);c.addColorStop(0,this.gradientStart),c.addColorStop(1,this.gradientEnd),this.ctx.strokeStyle=c}else this.ctx.strokeStyle=this.color;this.ctx.stroke(),this.ctx.closePath(),t.depth===this.depth-1&&e.push({sx:t.startX,sy:t.startY,ex:t.endX,ey:t.endY,depth:t.depth})}let h=!1;if(this.currentDepth<this.depth){let s=!0;for(let r=0;r<this.branches[this.currentDepth].length;r++){const t=this.branches[this.currentDepth][r];if(t.cntFrame<t.frame)t.draw(this.ctx,this.growthSpeed),h=!0,s=!1;else{if(this.ctx.beginPath(),this.ctx.moveTo(t.startX,t.startY),this.ctx.lineTo(t.endX,t.endY),this.ctx.lineWidth=t.lineWidth,this.colorMode==="gradient"){const c=this.ctx.createLinearGradient(this.treeX,this.treeY,this.treeX,this.treeTop);c.addColorStop(0,this.gradientStart),c.addColorStop(1,this.gradientEnd),this.ctx.strokeStyle=c}else this.ctx.strokeStyle=this.color;this.ctx.stroke(),this.ctx.closePath(),t.depth===this.depth-1&&e.push({sx:t.startX,sy:t.startY,ex:t.endX,ey:t.endY,depth:t.depth})}}s&&(this.currentDepth++,h=!0)}for(const s of e)this.drawLeaf(s.ex,s.ey);for(const s of e)if(this.depth===this.fullDepth&&this.random(0,1)<.05){const r=s.ex-s.sx,t=s.ey-s.sy,c=Math.hypot(r,t)||1,f=r/c,x=t/c,o=Math.min(this.leafSize*.35,8),d=s.ex+f*o,n=s.ey+x*o,a=Math.max(3,Math.floor(this.leafSize*.2));this.ctx.beginPath(),this.ctx.arc(d,n,a,0,Math.PI*2),this.ctx.fillStyle="red",this.ctx.fill(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(d-a*.35,n-a*.35,a*.35,0,Math.PI*2),this.ctx.fillStyle="rgba(255,255,255,0.7)",this.ctx.fill(),this.ctx.closePath()}h?this.animation=requestAnimationFrame(this.animate.bind(this)):this.animation&&cancelAnimationFrame(this.animation)}}function C(){const g=u.useRef(null),e=u.useRef(null),[h,s]=u.useState(50),[r,t]=u.useState({seed:"Dmitry",depth:1,growthSpeed:50,treeScale:1,branchWidth:1,colorMode:"gradient",color:"#000000",gradientColorStart:"#8B4513",gradientColorEnd:"#228B22",leafColor:"#228B22",leafSize:15,container:null,treeRef:null}),c=()=>{console.log({options:r}),console.log({tree:e.current}),g.current&&!e.current&&(e.current=new b({...r,container:g.current}))},f=()=>{if(e.current&&h>=10){e.current.growOneLevel(),s(l=>l-10);const a=e.current.originalSeed;t(l=>({...l,...e.current,seed:a}))}};u.useEffect(()=>{c()},[r]);const x=a=>{const l=d.find(m=>m.id===a);if(l&&!l.isCompleted){s(p=>p+l.reward),l.isCompleted=!0;const m=d.map(p=>p.id===a?l:p);n(m)}},o=new Array(15).fill(1).map((a,l)=>({id:l+1}));console.log(o);const[d,n]=u.useState([{id:1,title:"📝 Пройти тест",description:"Пройдите небольшой тест по вашей профессии и получите баллы",reward:5,isCompleted:!1},{id:2,title:"📊 Заполнить опросник",description:"Ответьте на вопросы опросника о вашей работе и получите воду",reward:10,isCompleted:!1},{id:3,title:"💬 Записаться на форум",description:"Присоединитесь к профессиональному форуму и заработайте баллы",reward:7,isCompleted:!1}]);return i.jsxs("div",{className:"flex justify-evenly w-full h-screen gap-4 p-4 max-[52rem]:flex-col-reverse max-[52rem]:items-center ",children:[i.jsx("div",{className:"flex flex-wrap items-start gap-4 justify-center-safe xl:max-w-4xl",children:o.map(a=>i.jsx(v,{to:"/forest",className:"[&.active]:font-bold block p-1",children:i.jsxs("div",{className:"flex flex-col items-center justify-center cursor-pointer",children:[i.jsx("span",{className:" font-futura-heavy",children:"Дерево другого пользователя"}),i.jsx("img",{src:"https://media.istockphoto.com/id/543052538/nl/foto/tree.webp?s=2048x2048&w=is&k=20&c=-8vJIKAwtEVvJND28S4KC9aY6mTWncdiOPQZAtbEsTs=",width:200,height:200,className:"rounded-md",alt:""})]})},a.id))}),i.jsxs("div",{className:"flex flex-col items-center gap-2",children:[i.jsxs("div",{className:"flex flex-col text-lg",children:[i.jsxs("p",{children:["Имя: ",i.jsx("span",{className:"font-futura-heavy",children:"Дмитрий Кулаков"})]}),i.jsxs("p",{children:["Возраст дерева:"," ",i.jsx("span",{className:"font-futura-heavy",children:"2 дня"})," "]}),i.jsxs("p",{children:["Следующее время поливки:"," ",i.jsx("span",{className:"font-futura-heavy",children:"Через неделю"})]}),i.jsxs("p",{children:["Стадия роста: ",i.jsx("span",{className:"font-futura-heavy",children:"Cаженец"})]}),i.jsxs("p",{children:["Следующая стадия через:"," ",i.jsx("span",{className:"font-futura-heavy",children:"60 дней"})]})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"flex border shadow-md rounded-md h-[300px] bg-white   max-lg:w-[300px] max-lg:max-w-[300px] max-xl:w-[400px] max-xl:max-w-[400px] w-[500px] max-w-[500px]",ref:g}),i.jsx("div",{children:i.jsxs("p",{className:"text-xl",children:["Текущее количество воды:"," ",i.jsxs("span",{className:"font-futura-heavy",children:[h,"💧"]})]})}),i.jsx("button",{onClick:f,className:"w-full p-2 mt-4 bg-blue-300 rounded cursor-pointer font-futura-heavy",children:"Полить ( -10💧)"}),i.jsxs("div",{className:"w-full mt-4",children:[i.jsx("h2",{className:"text-xl mb-2 text-center max-[52rem]:text-lg",children:"Задачи для получения воды:"}),i.jsx("div",{className:"flex flex-wrap gap-4 justify-center max-[52rem]:flex-col max-[52rem]:items-center",children:d.map(a=>i.jsxs("div",{className:`flex flex-col justify-between  rounded-md shadow-md p-4 ${a.isCompleted?"bg-green-400":"bg-white"} ${a.isCompleted?"hover:bg-green-600 border-green-600":"hover:bg-blue-50"}  transition-colors cursor-pointer w-[200px] max-[52rem]:w-[90%]`,onClick:()=>x(a.id),children:[i.jsx("h3",{className:"text-lg text-center text-black font-futura-heavy",children:a.title}),i.jsx("p",{className:"text-center text-black ",children:a.description}),i.jsxs("p",{className:"mt-2 text-center text-blue-600 font-futura-heavy",children:["+",a.reward,"💧"]})]},a.id))})]})]})]})]})}export{C as component};
